<div class="container-fluid p-0" style="height: 100vh; overflow: hidden;">
  <div class="row h-100 g-0">

    <!-- ğŸ“‹ å·¦ä¾§ç”¨æˆ·åˆ—è¡¨ -->
    <div class="col-3 border-end d-flex flex-column bg-light">
      <div class="d-flex justify-content-between align-items-center px-3 py-2 border-bottom">
        <h6 class="mb-0">ç”¨æˆ·åˆ—è¡¨</h6>
        <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#addUserModal">
          <i class="bi bi-plus"></i> æ–°å¢ç”¨æˆ·
        </button>
      </div>
      <div class="flex-grow-1 overflow-auto">
        <ul class="list-group list-group-flush">
          <li class="list-group-item list-group-item-action" ng-repeat="user in users" ng-click="selectUser(user)"
            ng-class="{'active': selectedUser && selectedUser.id === user.id}" style="cursor: pointer;">
            <div class="fw-semibold">{{user.id}},{{ user.name }}</div>
            <div class="text-muted small">{{ user.email || user.phone || 'æ— è”ç³»æ–¹å¼' }}</div>
          </li>
        </ul>
      </div>
    </div>

    <!-- æ–°å¢ç”¨æˆ·æ¨¡æ€æ¡† -->
    <div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addUserModalLabel">æ–°å¢ç”¨æˆ·</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="å…³é—­"></button>
          </div>
          <div class="modal-body">
            <form id="addUserForm">
              <div class="mb-3">
                <label class="form-label">åç§°</label>
                <input type="text" class="form-control" ng-model="newUser.name" required>
              </div>
              <div class="mb-3">
                <label class="form-label">ç”¨æˆ·ç±»å‹</label>
                <input type="text" class="form-control" ng-model="newUser.user_type">
              </div>
              <div class="mb-3">
                <label class="form-label">çŠ¶æ€</label>
                <select class="form-select" ng-model="newUser.status">
                  <option value="1">å¯ç”¨</option>
                  <option value="0">ç¦ç”¨</option>
                </select>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
            <button type="button" class="btn btn-primary" ng-click="addUser()">ç¡®è®¤æ–°å¢</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ğŸ¯ å³ä¾§è§’è‰²ç»‘å®š -->
    <div class="col-9 d-flex flex-column">
      <div class="px-4 py-3 border-bottom bg-white">
        <h5 class="mb-0">
          <span ng-if="selectedUser">ç»‘å®šè§’è‰²ï¼š{{ selectedUser.name }}</span>
          <span ng-if="!selectedUser" class="text-muted fst-italic">è¯·é€‰æ‹©å·¦ä¾§ç”¨æˆ·</span>
        </h5>
      </div>

      <div class="flex-grow-1 overflow-auto p-4" ng-if="selectedUser">
        <div class="row row-cols-1 row-cols-md-2 g-3">
          <div class="col" ng-repeat="role in roles">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="role-{{role.id}}" ng-model="role.checked" />
              <label class="form-check-label" for="role-{{role.id}}">
                {{ role.display_name || role.name }}
              </label>
            </div>
          </div>
        </div>

        <div class="mt-4">
          <button class="btn btn-primary" ng-click="saveUserRoles()" ng-disabled="saving">
            <span ng-if="!saving">ä¿å­˜ç»‘å®šè§’è‰²</span>
            <span ng-if="saving"><span class="spinner-border spinner-border-sm me-1"></span>ä¿å­˜ä¸­...</span>
          </button>
        </div>
      </div>
    </div>

  </div>
</div>